<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640">

    <link rel="stylesheet" href="stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">
    <link rel="stylesheet" href="stylesheets/github-light.css">

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Lazy-attribute by selvachezhian</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/selvachezhian/lazy-attribute">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Lazy-attribute</h1>
            <h2>Minimizing find_by query for a single repeated attribute</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/selvachezhian/lazy-attribute/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/selvachezhian/lazy-attribute/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <h1>
<a id="lazy-attribute" class="anchor" href="#lazy-attribute" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Lazy Attribute</h1>

<p>This gem provides a simple and extremely flexible way to use most frequent find_by query in a model.
You can minimize find_by query of a particular attribute in a model using lazy attribute gem.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<pre><code>gem 'lazy-attribute'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install lazy-attribute
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<p>In Model</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">User<span class="pl-e"> &lt; ActiveRecord::Base</span></span>

  lazy_attribute <span class="pl-c1">:email</span>

<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">User</span>[<span class="pl-s"><span class="pl-pds">'</span>sample@email.com<span class="pl-pds">'</span></span>]</pre></div>

<p>Will give you the user object matches with the email and will return nil if record not found</p>

<div class="highlight highlight-source-ruby"><pre>lazy_attribute <span class="pl-c1">:email</span>, <span class="pl-c1">raise_error:</span> <span class="pl-c1">true</span></pre></div>

<p>Will give you the user object matches with the email and will raise <code>ActiveRecord::RecordNotFound</code> Exception if record not found</p>

<p>You can use more than one lazy_attribute to your model by providing unique key for that</p>

<div class="highlight highlight-source-ruby"><pre>lazy_attribute <span class="pl-c1">:first_name</span>, <span class="pl-c1">raise_error:</span> <span class="pl-c1">true</span>, <span class="pl-c1">key:</span> <span class="pl-c1">:fn</span></pre></div>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">User</span>.fn(<span class="pl-s"><span class="pl-pds">'</span>first name<span class="pl-pds">'</span></span>)</pre></div>

<div class="highlight highlight-source-ruby"><pre>lazy_attribute <span class="pl-c1">:email</span>, <span class="pl-c1">create_if_not_found:</span> <span class="pl-c1">true</span></pre></div>

<p>Will try to fetch the user object with the matched email address, if the record is not found in the db the same will be created.  If any error like validation protected the record being saved, then the new built object will be returned.</p>

<div class="highlight highlight-source-ruby"><pre>user <span class="pl-k">=</span> <span class="pl-c1">User</span>[<span class="pl-s"><span class="pl-pds">'</span>invalid email<span class="pl-pds">'</span></span>]

user.errors.message
=&gt; {<span class="pl-c1">:email</span>=&gt;[<span class="pl-s"><span class="pl-pds">"</span>Please enter valid email format<span class="pl-pds">"</span></span>]}</pre></div>

<p>if you want the exception needs to be threw, then use the <code>raise_error: true</code> option</p>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/selvachezhian">selvachezhian</a> can be found on <a href="https://github.com/selvachezhian/lazy-attribute">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="https://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

    
  </body>
</html>
